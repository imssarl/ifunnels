(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{274:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return c}));var s=n(9),a=n.n(s),r=n(11),i=n.n(r),u=n(12),o=n.n(u),l=n(213),d=n.n(l),c=function(){function e(){a()(this,e),this.delay=5e3;var t=lockscreen,n=t.requestUrl,s=t.authUrl,r=t.isBackend;this.requestUrl=n,this.authUrl=s,this.enableRecursive=!0,this.inputKeys={username:r?"email":"username",passwd:"passwd"},this.modalDOM=document.querySelector(".lockscreen"),this.username=r||d.a.get("loginName"),this.usernameDOMElement=document.querySelector(".lockscreen__container__username"),this.usernameSingInDOMElement=this.modalDOM.querySelector(".lockscreen__signin"),this.usernameDOMInput=this.modalDOM.querySelector('[name="arrLogin['.concat(this.inputKeys.username,']"]')),this.passwordDOMInput=this.modalDOM.querySelector('[name="arrLogin['.concat(this.inputKeys.passwd,']"]')),this.init()}return i()(e,[{key:"init",value:function(){this.outputUserName(),this.recursiveQuery(),this.bindActions()}},{key:"bindActions",value:function(){var e=this;this.modalDOM.querySelector("form").addEventListener("submit",(function(t){t.preventDefault();var n=new FormData;n.append("arrLogin[".concat(e.inputKeys.username,"]"),e.usernameDOMInput.value),n.append("arrLogin[".concat(e.inputKeys.passwd,"]"),e.passwordDOMInput.value),o()({method:"post",url:e.authUrl,data:n,headers:{"Content-Type":"multipart/form-data"}}).then((function(t){200===t.status&&(t.data.authorized?(e.hideModal(),e.resetForm(),e.recursiveQuery(),isSigned=!0):e.passwordDOMInput.classList.add("error-field"))}))}))}},{key:"resetForm",value:function(){this.usernameDOMInput.value=this.username,this.passwordDOMInput.value="",this.passwordDOMInput.classList.remove("error-field")}},{key:"outputUserName",value:function(){this.usernameDOMElement&&(this.usernameDOMElement.innerHTML="".concat(this.username||"Unknown User"),this.usernameDOMInput.value=this.username,this.usernameSingInDOMElement.children[0].innerHTML=this.username)}},{key:"recursiveQuery",value:function(){var e=this;this.handlerInterval=setInterval((function(){e.sendRequest()}),this.delay)}},{key:"sendRequest",value:function(){var e=this;o.a.get(this.requestUrl).then((function(t){var n=t.data;n.hasOwnProperty("authorized")&&!1===n.authorized&&(e.enableRecursive=!1,clearInterval(e.handlerInterval),isSigned=!1,e.showModal())}))}},{key:"showModal",value:function(){this.modalDOM.style.display="flex",document.body.classList.add("overflow-hidden")}},{key:"hideModal",value:function(){this.modalDOM.style.display="none",document.body.classList.remove("overflow-hidden")}}]),e}()}}]);